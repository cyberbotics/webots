<!DOCTYPE html>
<html>
  <head>
    <meta charset='UTF-8'>
    <link type="text/css" rel="stylesheet" href='webots://projects/samples/robotbenchmark/include/tabs.css' />
    <link rel="icon" type="image/png" href="https://cyberbotics.com/assets/images/webots.png">
  </head>
  <body>
    <div id='infotabs' class='wrapper webotsTabs'>
      <div>
        <input class="radio" id="overview" name="group" type="radio" checked>
        <label class="tab" for="overview">Overview</label>
        <div class="panel">
          <p>This benchmark will teach you how to program a robot and run the simulation.</p>
          <p>The tab entitled <b>Metrics</b> measures your progress on an
            exercise where you have to program a robot to cover a certain distance. It also allows you to record your performance in
            the robotbenchmark database (if you are logged-in).</p>
          <p>The tab entitled <b>Instructions</b> explains you how to
            open the source code editor to edit the robot controller program, save it and run the simulation with your modified code.
          </p>
        </div>
        <input class="radio" id="metrics" name="group" type="radio">
        <label class="tab" for="metrics">Metrics</label>
        <div class="panel">
          <div style='text-align:center' title='Your performance increases as you get closer to the target position.'>
            <span id='achievement'>0%</span></div>
          <br>
          <p>Program the Thymio II robot to move straight forward and stop. The performance value increases as the robot gets closer
           to the target position situated exactly one parquetry square in front of it. It will decrease if the robot continues aways
           from this position.
           The <b>Instructions</b> tab explains the step-by-step
           procedure to follow.</p>
        </div>
        <input class="radio" id="instructions" name="group" type="radio">
        <label class="tab" for="instructions">Instructions</label>
        <div class="panel">
          <h2>Programming a robot in Python</h2>
           <ol>
            <li><b>Open the source code editor</b>: click on the robot with the right mouse button to pop up the robot contextual menu
             and select the "Edit controller" item. A window should open containing the source code of the controller of the robot.
             This is actually a simple Python program.
            </li>
            <li><b>Edit the controller</b>: on line 7, modify the value assigned to the <em>target</em> variable: instead of
             <em>0</em>, try to set a different value, for example 10.</li>
            <li><b>Save your program</b>: in the source code editor, press <em id='saveShortcut'>Ctrl-S</em> to save your program.
            </li>
            <li><b>Reset the simulation</b>: press the reset button
             <img src='reset.png' alt='reset'> to take into account your modifications.</li>
            <li><b>Run the simulation</b>: press the play button <img src='real_time.png' alt='real-time'> to run the simulation.
            </li>
            <li><b>Observe the result</b>: the robot should move forward. Your performance should be updated in real time on the
             <b>Metrics</b> tab. After a while, the robot should stop and
             your performance should be recorded (if you are logged in).
             Try to modify the controller program again to achieve a better performance.
            </li>
           </ol>
           <p>During the execution, the sample controller prints some output on the console.
             You can open the console by clicking on the toolbar button <img src='console.png' alt='console'>.
           </p>
        </div>
        <input class="radio" id="explanations" name="group" type="radio">
        <label class="tab" for="explanations">Explanations</label>
        <div class="panel">
          <h2>Thymio II position control</h2>
           <p>The provided controller program drives the Thymio II robot in position control. That is, for each motor of the robot, it
            defines a target position that the motor has to reach. This position corresponds to an angular position of the wheel and is
            expressed in radians. Given that each wheel has a radius of 21 millimeters, a target value of 10 on each motor will make the
            robot move forward by a distance of 10 x 21, that is about 210 millimeters. The size of a parquetry square being 250
            millimeters, a target position of 10 will probably not drive the robot at the very correct position...
          </p>
        </div>
      </div>
    </div>
    <script type="module" src="robot_programming.js"></script>
    <script>
      let height;
      function adaptPositionOfText() {
        let tabs = document.getElementsByClassName('tab')
        if(!tabs.length > 0)
          return
        let newHeight = tabs[tabs.length - 1].getBoundingClientRect().top + tabs[tabs.length - 1].getBoundingClientRect().height;
        if(newHeight === height)
          return;
        height = newHeight;
        let panels = document.getElementsByClassName('panel');
        Array.from(panels).forEach((panel) => {
          panel.style.top = height + 'px';
        });
      }
      window.addEventListener('resize', adaptPositionOfText);
      adaptPositionOfText();
    </script>
  </body>
</html>
